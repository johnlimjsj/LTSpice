Version 4
SHEET 1 1900 3184
WIRE -208 -32 -304 -32
WIRE -208 0 -304 0
WIRE -208 32 -304 32
WIRE 1392 960 1264 960
WIRE 1392 1008 1392 960
WIRE -752 1024 -752 976
WIRE 1216 1024 1216 960
WIRE 1264 1024 1264 960
WIRE 288 1040 128 1040
WIRE 480 1040 368 1040
WIRE 720 1040 480 1040
WIRE 832 1040 720 1040
WIRE 1200 1072 1152 1072
WIRE 1312 1072 1280 1072
WIRE 352 1104 352 1088
WIRE 352 1120 352 1104
WIRE 304 1136 304 1088
WIRE -752 1152 -752 1104
WIRE -752 1152 -864 1152
WIRE 832 1152 832 1040
WIRE -752 1200 -752 1152
WIRE 480 1200 480 1040
WIRE -864 1216 -864 1152
WIRE 432 1216 384 1216
WIRE 1152 1216 1152 1072
WIRE 1200 1216 1152 1216
WIRE 1312 1216 1312 1072
WIRE 1312 1216 1264 1216
WIRE -1264 1232 -1264 1152
WIRE -1072 1232 -1072 1152
WIRE 48 1232 16 1232
WIRE 128 1232 128 1040
WIRE 128 1232 48 1232
WIRE 432 1264 400 1264
WIRE 1760 1280 1600 1280
WIRE -752 1328 -752 1280
WIRE 480 1328 480 1280
WIRE 1216 1328 1216 1296
WIRE 1600 1328 1600 1280
WIRE 1648 1328 1600 1328
WIRE 832 1344 832 1216
WIRE 1152 1344 1152 1216
WIRE 1152 1344 832 1344
WIRE 1184 1344 1152 1344
WIRE 1760 1344 1760 1280
WIRE 1760 1344 1712 1344
WIRE 1824 1344 1760 1344
WIRE -1264 1360 -1264 1312
WIRE -1072 1360 -1072 1312
WIRE -752 1360 -752 1328
WIRE 1312 1360 1312 1216
WIRE 1312 1360 1248 1360
WIRE 1376 1360 1312 1360
WIRE 1600 1360 1456 1360
WIRE 1648 1360 1600 1360
WIRE 1184 1376 1136 1376
WIRE 1600 1376 1600 1360
WIRE 688 1408 688 1344
WIRE 1600 1408 1600 1376
WIRE 1136 1424 1136 1376
WIRE 1216 1424 1216 1392
WIRE 1216 1440 1216 1424
WIRE 1440 1440 1440 1408
WIRE 128 1456 128 1232
WIRE 288 1456 128 1456
WIRE 464 1456 368 1456
WIRE 624 1456 464 1456
WIRE 832 1456 832 1344
WIRE 832 1456 752 1456
WIRE 1392 1456 1392 1408
WIRE 1600 1504 1600 1472
WIRE -1072 1520 -1072 1504
WIRE 352 1536 352 1504
WIRE 304 1552 304 1504
WIRE -1264 1584 -1264 1504
WIRE -1072 1584 -1072 1520
WIRE -640 1584 -640 1504
WIRE -208 1600 -208 1520
WIRE 464 1664 464 1456
WIRE 416 1680 368 1680
WIRE -1872 1712 -1872 1632
WIRE -1264 1712 -1264 1664
WIRE -1072 1712 -1072 1664
WIRE -640 1712 -640 1664
WIRE -1904 1728 -2112 1728
WIRE -208 1728 -208 1680
WIRE 400 1728 384 1728
WIRE 416 1728 400 1728
WIRE -1648 1744 -1840 1744
WIRE -1904 1760 -2000 1760
WIRE 1392 1760 1296 1760
WIRE 1504 1760 1472 1760
WIRE 464 1792 464 1744
WIRE -2112 1808 -2112 1728
WIRE 1376 1824 1376 1792
WIRE -2000 1840 -2000 1760
WIRE -1872 1840 -1872 1776
WIRE 1136 1840 992 1840
WIRE 1296 1840 1296 1760
WIRE 1296 1840 1216 1840
WIRE 1344 1840 1296 1840
WIRE 992 1856 992 1840
WIRE 1488 1856 1408 1856
WIRE 1504 1856 1504 1760
WIRE 1504 1856 1488 1856
WIRE 1344 1872 1296 1872
WIRE 1296 1920 1296 1872
WIRE 1376 1920 1376 1888
WIRE -2112 1936 -2112 1888
WIRE 1376 1936 1376 1920
WIRE -2000 1968 -2000 1920
WIRE 992 1984 992 1936
WIRE 1392 2032 1296 2032
WIRE 1504 2032 1472 2032
WIRE 1136 2112 992 2112
WIRE 1296 2112 1296 2032
WIRE 1296 2112 1216 2112
WIRE 1344 2112 1296 2112
WIRE 992 2128 992 2112
WIRE 1472 2128 1408 2128
WIRE 1504 2128 1504 2032
WIRE 1504 2128 1472 2128
WIRE 1344 2144 1296 2144
WIRE 1296 2192 1296 2144
WIRE 992 2256 992 2208
WIRE 400 2496 384 2496
WIRE 512 2496 400 2496
WIRE 720 2496 592 2496
WIRE 896 2496 720 2496
WIRE 720 2512 720 2496
WIRE 576 2560 576 2544
WIRE 576 2576 576 2560
WIRE 960 2576 960 2544
WIRE 528 2592 528 2544
WIRE 720 2592 720 2512
WIRE 912 2592 912 2544
WIRE 720 2784 720 2656
FLAG -208 32 Vdd
IOPIN -208 32 Out
FLAG -208 0 phi1_
IOPIN -208 0 Out
FLAG -208 -32 phi1
IOPIN -208 -32 Out
FLAG 720 2784 0
FLAG 912 2592 0
FLAG 720 2512 c4_ic
FLAG 1136 1424 0
FLAG 1312 1216 c5_ic
FLAG 1392 1008 0
FLAG 528 2592 0
FLAG -1264 1360 0
FLAG -1072 1360 0
FLAG -1264 1712 0
FLAG -1072 1712 0
FLAG -1264 1504 Input
FLAG -1072 1520 p1
FLAG -1072 1152 p2
FLAG -1264 1152 reset
FLAG 400 2496 Vosc
FLAG 576 2560 p1
FLAG 960 2576 p2
FLAG 1216 960 reset
FLAG 1600 1504 0
FLAG 1392 1456 0
FLAG 1440 1440 sam
FLAG -640 1712 0
FLAG -640 1504 sam
FLAG 1824 1344 Vout
FLAG -864 1216 0
FLAG -752 976 Vcc
FLAG -752 1328 Vee
FLAG 1216 1296 Vcc
FLAG 1216 1424 Vee
FLAG 304 1136 0
FLAG 352 1104 p1
FLAG 384 1216 0
FLAG 400 1264 p2
FLAG 304 1552 0
FLAG 352 1536 p2
FLAG 368 1680 0
FLAG 400 1728 p1
FLAG 480 1328 0
FLAG 464 1792 0
FLAG 48 1232 Input
FLAG 720 1040 cref_ic
FLAG 1600 1376 ch_ic
FLAG 1296 1920 0
FLAG 992 1984 0
FLAG 1296 2192 0
FLAG 992 2256 0
FLAG 1376 1792 Vcc
FLAG 1376 1920 Vee
FLAG 1488 1856 Vlt1001
FLAG 1472 2128 Videal
FLAG -208 1728 0
FLAG -208 1520 Vpressure
FLAG 688 1344 Vpressure
FLAG -1872 1632 Vcc
FLAG -1872 1840 Vee
FLAG -2000 1968 0
FLAG -2112 1936 0
SYMBOL powerBench -368 0 R0
SYMATTR InstName X1
SYMATTR SpiceLine Vmax=5 Ton=0.05m Tp=0.5m
SYMBOL cap 704 2592 R0
SYMATTR InstName C4
SYMATTR Value {Cin}
SYMBOL sw 880 2496 R270
SYMATTR InstName S1
SYMBOL sw 1296 1072 R90
SYMATTR InstName S2
SYMBOL sw 496 2496 R270
SYMATTR InstName S4
SYMBOL voltage -1264 1216 R0
WINDOW 3 -161 -1 Invisible 2
SYMATTR Value PULSE(0 {v_on} {reset_offset} {t_rise} {t_fall} {reset_t_on} {t_period} {cycle})
SYMATTR InstName V3
SYMBOL voltage -1072 1216 R0
WINDOW 3 -71 116 Invisible 2
SYMATTR Value PULSE(0 {v_on} {p2_offset} {t_rise} {t_fall} {t_on} {t_period} {cycle})
SYMATTR InstName V4
SYMBOL voltage -1264 1568 R0
WINDOW 3 -196 -32 Left 2
SYMATTR Value 1.5
SYMATTR InstName V8
SYMBOL voltage -1072 1568 R0
WINDOW 3 -81 108 Invisible 2
SYMATTR Value PULSE(0 {v_on} {p1_offset} {t_rise} {t_fall} {t_on} {t_period} {cycle})
SYMATTR InstName V9
SYMBOL Opamps/opamp 1680 1280 R0
SYMATTR InstName U1
SYMBOL sw 1360 1360 R270
SYMATTR InstName S3
SYMBOL cap 1584 1408 R0
SYMATTR InstName Ch
SYMATTR Value {c_hold_base*c_scale}
SYMBOL voltage -640 1568 R0
WINDOW 3 -161 -1 Invisible 2
SYMATTR Value PULSE(0 {v_on} {sam_offset} {t_rise} {t_fall} {sam_t_on} {t_period} {cycle})
SYMATTR InstName V1
SYMBOL voltage -752 1008 R0
SYMATTR InstName V2
SYMATTR Value 15
SYMBOL voltage -752 1184 R0
SYMATTR InstName V5
SYMATTR Value 15
SYMBOL sw 272 1040 R270
SYMATTR InstName S5
SYMBOL sw 480 1184 R0
SYMATTR InstName S6
SYMBOL sw 272 1456 R270
SYMATTR InstName S7
SYMBOL sw 464 1648 R0
SYMATTR InstName S8
SYMBOL cap 816 1152 R0
WINDOW 3 24 56 Invisible 2
SYMATTR Value {c_in_base*c_scale}
SYMATTR InstName Cref
SYMBOL Opamps/LT1001 1376 1792 R0
SYMATTR InstName U2
SYMBOL res 1232 1824 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value R=11-time*0.1
SYMBOL voltage 992 1840 R0
SYMATTR InstName V6
SYMATTR Value ""
SYMATTR Value2 AC 1
SYMBOL res 1232 2096 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL voltage 992 2112 R0
WINDOW 3 24 38 Left 2
SYMATTR Value 5
SYMATTR InstName V7
SYMATTR Value2 AC 1
SYMBOL Opamps/opamp 1376 2064 R0
SYMATTR InstName U4
SYMATTR SpiceLine Aol=10K
SYMBOL Opamps/opamp 1216 1296 R0
SYMATTR InstName U3
SYMBOL voltage -208 1584 R0
WINDOW 3 -196 -32 Left 2
SYMATTR Value 1
SYMATTR InstName V10
SYMBOL cap 1264 1200 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 Invisible 2
SYMATTR InstName C1
SYMATTR Value {c_f_base*c_scale}
SYMBOL SENSOR_CAP 640 1456 R180
WINDOW 39 0 0 Invisible 2
SYMATTR SpiceLine Cbase={Cin}
SYMATTR InstName CapSensor
SYMBOL voltage -2000 1824 R0
WINDOW 3 24 38 Center 2
SYMATTR Value 3.95
SYMATTR InstName V11
SYMBOL voltage -2112 1792 R0
WINDOW 3 24 38 Center 2
SYMATTR Value 4
SYMATTR InstName V12
SYMBOL Comparators/LTC6752 -1872 1680 R0
SYMATTR InstName U6
TEXT -280 3144 Left 2 !.tran {5m*scale} {10m*scale}
TEXT -272 2720 Left 2 !.model SW SW(Ron=0.001 Roff=10g Vt=1.1 Vh=0.1)
TEXT -280 2896 Left 2 !.ic V(Vci) = 0\n.ic V(c4_ic)=0\n.ic V(c5_ic)=0\n.ic V(c6_ic)=0\n.ic V(cref_ic)=0\n.ic V(csense_ic)=0\n.ic V(ch_ic)=0\n.ic V(ctest_ic)=0
TEXT -264 1992 Left 2 !.step param Cx list 1 2
TEXT -272 2696 Left 2 !.lib opamp.sub
TEXT -280 3168 Left 2 ;.ac oct 100 1 10000k
TEXT -992 2320 Left 2 !.param v_on 5\n.param t_period {1m*scale}\n.param t_on {0.48m*scale}\n.param t_rise {1n*scale}\n.param t_fall {1n*scale}\n.param cycle 1000
TEXT -992 2568 Left 2 !.param p1_offset {0}\n.param p2_offset {p1_offset+t_on*1.05}\n.param sam_offset {p1_offset+1.5*t_on}\n.param reset_offset {0}
TEXT -992 2152 Left 2 !.param sam_t_on {t_on*0.25}\n.param reset_t_on {t_on*0.25}
TEXT -992 1976 Left 2 !.param scale 0.01
TEXT -992 2288 Left 2 ;timing params
TEXT -272 3096 Left 2 ;Analysis Commands
TEXT -264 2856 Left 2 ;Initial Capacitor Conditions
TEXT -264 2656 Left 2 ;Model Definitions
TEXT -264 1952 Left 2 ;Changing Input
TEXT -264 2520 Left 2 !.param c_scale 1
TEXT -264 2480 Left 2 ;Capacitance Scale
TEXT -264 2352 Left 2 !.param c_in_base 2u\n.param c_f_base 1u\n.param c_hold_base 0.5u
TEXT -264 2312 Left 2 ;Capacitance Scale
TEXT -264 2024 Left 2 !.param Cin table {Cx, 1, c_in_base*c_scale, 2, c_in_base*c_scale*0.8, 3, c_in_base*c_scale*0.6}
TEXT -256 2184 Left 2 !.param v_time 3
